webpackJsonp([1],{102:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"app"}},103:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){var i=t(15),r=t.n(i),o=t(18),a=t(71),s=(t.n(a),t(28));n.default={name:"scene-running",data:function(){return{renderDom:void 0,runner:a.Runner.create(),viewPort:{min:{x:0,y:0},max:{x:800,y:600}}}},computed:r()({},t.i(s.a)(["runningRender","engine"])),watch:{viewPort:{handler:function(){a.Render.lookAt(this.runningRender,this.viewPort)},deep:!0}},methods:r()({},t.i(s.c)({initSceneRunning:o.c}),{sceneStart:function(){a.Runner.start(this.runner,this.engine)},scenePause:function(){a.Runner.stop(this.runner)},sceneReset:function(){a.Common._nextId=0,a.Common._seed=0,a.Render.stop(this.runningRender),a.Runner.stop(this.runner),this.runningRender.canvas.parentElement.removeChild(this.runningRender.canvas),this.initSceneRunning(),this.renderScene()},renderScene:function(){this.renderDom.appendChild(this.runningRender.canvas),a.Render.lookAt(this.runningRender,this.viewPort),this.runningRender.canvas.width=this.renderDom.clientWidth,this.runningRender.canvas.height=this.renderDom.clientHeight,a.Render.run(this.runningRender)},handleAdd:function(){}}),mounted:function(){this.renderDom=e("#scene-running-runningRender")[0],this.initSceneRunning(),this.renderScene()}}}.call(n,t(49))},104:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){var i=t(108),r=t.n(i),o=t(15),a=t.n(o),s=t(18),c=t(28),l=t(180),u=t.n(l),d=t(178),h=t.n(d);n.default={name:"vml-workbench",data:function(){return{storage:window.localStorage,sceneEditorSpan:12,sceneRunningSpan:12}},computed:a()({},t.i(c.a)(["fileName","sceneData"]),{storageFileNames:function(){for(var e=[],n=0;n<this.storage.length;n++)e.push(this.storage.key(n));return e}}),watch:{storageFileNames:function(){}},methods:a()({},t.i(c.b)({saveScene:s.a}),t.i(c.c)({initSceneEditor:s.b,initSceneRunning:s.c}),{handleSelect:function(e){switch(e){case"createScene":this.saveScene({fileName:e,sceneData:this.storage.getItem(e)});break;case"showScene":console.log(r()(this.sceneData));break;case"importScene":break;case"saveScene":this.storage.setItem(this.fileName,r()(this.sceneData,null,2));break;default:console.error("unknown menu key:"+e)}},importScene:function(){var n=e("#import-scene-input")[0].files[0],t=new FileReader;t.readAsText(n);var i=this;t.onload=function(){console.log(n.name),console.log(this.result),i.saveScene({fileName:n.name,sceneData:JSON.parse(this.result)})}},sceneEdit:function(){this.sceneEditorSpan=24,this.sceneRunningSpan=0},sceneHalf:function(){this.sceneEditorSpan=12,this.sceneRunningSpan=12},sceneRunning:function(){this.sceneEditorSpan=0,this.sceneRunningSpan=24}}),beforeMount:function(){this.initSceneEditor(),this.initSceneRunning()},components:{SceneEditor:u.a,SceneRunning:h.a}}}.call(n,t(49))},105:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){var i=t(15),r=t.n(i),o=t(18),a=t(28),s=t(52);n.default={name:"scene-editor",data:function(){return{vertices:[],edges:[]}},computed:r()({},t.i(a.a)(["fileName","editorGraph","sceneData"])),methods:r()({},t.i(a.b)({saveScene:o.a}),t.i(a.c)({initSceneEditor:o.b}),{saveSceneData:function(){this.saveScene({fileName:this.fileName,sceneData:s.a.encode(this.editorGraph.getModel())})},deleteBody:function(){console.log("delete")},undo:function(){console.log("undo")},redo:function(){console.log("redo")},initToolBar:function(){var e=document.getElementById("gscene-editor-palette"),n=new mxToolbar(e);n.enabled=!1;var t=new mxCell({label:"rectangle"},new mxGeometry(0,0,80,80),"");t.type="rectangle",t.setVertex(!0);var i=function(e,n,i){e.stopEditing(!1);var r=e.getPointForEvent(n),o=e.getModel().cloneCell(t);o.geometry.x=r.x,o.geometry.y=r.y,e.setSelectionCells(e.importCells([o],0,0,i))},r=n.addMode(null,"/static/mxgraph/src/images/rectangle.gif",i);mxUtils.makeDraggable(r,this.editorGraph,i)}}),mounted:function(){this.initToolBar(),this.editorGraph.init(e("#graph-container")[0]),this.editorGraph.view.refresh()}}}.call(n,t(49))},106:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t(29),r=t(78),o=t.n(r),a=t(74),s=t(75),c=t(76),l=t.n(c),u=t(77);t.n(u);i.a.config.productionTip=!1,i.a.use(l.a),new i.a({el:"#app",store:s.a,router:a.a,template:"<App/>",components:{App:o.a},strict:!1})},107:function(e,n){},165:function(e,n){},166:function(e,n){},167:function(e,n){},168:function(e,n){},169:function(e,n){e.exports={name:"scene-demo",description:"This is a test scene file",bodies:[{type:"rectangle",x:0,y:0,width:80,height:80,options:{label:"rectangle1",render:{fillStyle:"blue"}}},{type:"rectangle",x:150,y:50,width:80,height:80,options:{label:"rectangle2"}},{type:"rectangle",x:250,y:50,width:80,height:80,options:{label:"rectangle3",friction:0,frictionStatic:0,frictionAir:0}},{type:"rectangle",x:0,y:600,width:810,height:30,options:{label:"ground",isStatic:!0}}],gravity:{scale:.01,x:0,y:1}}},178:function(e,n,t){t(165);var i=t(27)(t(103),t(181),null,null);e.exports=i.exports},179:function(e,n,t){t(167);var i=t(27)(t(104),t(183),null,null);e.exports=i.exports},18:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"c",function(){return r}),t.d(n,"d",function(){return o}),t.d(n,"b",function(){return a}),t.d(n,"e",function(){return s}),t.d(n,"f",function(){return c});var i="sceneEditor/mutations/saveScene",r="sceneEditor/actions/initScenceRunning",o="sceneEditor/mutations/setRunningRender",a="sceneEditor/actions/initSceneEditor",s="sceneEditor/mutations/setEditorGraph",c="sceneEditor/mutations/setEditorSelectionCell"},180:function(e,n,t){t(166);var i=t(27)(t(105),t(182),"data-v-46c169f8",null);e.exports=i.exports},181:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticStyle:{height:"100%"},attrs:{id:"scene-running"}},[t("div",{attrs:{id:"scene-running-toolbar"}},[t("el-button",{attrs:{type:"primary",title:"开始",icon:"el-icon-caret-right"},on:{click:e.sceneStart}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"暂停",icon:"el-icon-circle-close"},on:{click:e.scenePause}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"重置",icon:"el-icon-refresh"},on:{click:e.sceneReset}})],1),e._v(" "),t("div",{attrs:{id:"scene-running-runningRender"}}),e._v(" "),t("div",{attrs:{id:"operation"}},[t("el-button",{on:{click:e.handleAdd}},[e._v("add object")]),e._v(" "),t("span",[e._v("view x:")]),e._v(" "),t("el-slider",{attrs:{max:1920},model:{value:e.viewPort.max.x,callback:function(n){e.$set(e.viewPort.max,"x",n)},expression:"viewPort.max.x"}}),e._v(" "),t("span",[e._v("view y:")]),e._v(" "),t("el-slider",{attrs:{max:1080},model:{value:e.viewPort.max.y,callback:function(n){e.$set(e.viewPort.max,"y",n)},expression:"viewPort.max.y"}})],1)])},staticRenderFns:[]}},182:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticStyle:{height:"100%"},attrs:{id:"scene-editor"}},[t("div",{attrs:{id:"scene-running-toolbar"}},[t("el-button",{attrs:{type:"primary",title:"保存",icon:"el-icon-document"},on:{click:e.saveSceneData}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"删除",icon:"el-icon-delete"},on:{click:e.deleteBody}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"撤销",icon:"el-icon-d-arrow-left"},on:{click:e.undo}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"恢复",icon:"el-icon-d-arrow-right"},on:{click:e.redo}})],1),e._v(" "),t("el-row",{staticStyle:{height:"100%"}},[t("el-col",{staticStyle:{height:"100%"},attrs:{span:4}},[t("div",{attrs:{id:"gscene-editor-palette"}}),e._v(" "),t("div",{attrs:{id:"scene-editor-outline"}}),e._v(" "),t("div",{attrs:{id:"property"}})]),e._v(" "),t("el-col",{staticStyle:{height:"100%"},attrs:{span:20}},[t("div",{attrs:{id:"graph-container"}})])],1)],1)},staticRenderFns:[]}},183:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"vml-workbench",staticStyle:{height:"100%:width:100%"}},[t("div",{attrs:{id:"menu"}},[t("el-menu",{attrs:{mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:e.handleSelect}},[t("el-submenu",{attrs:{index:"scene"}},[t("template",{attrs:{slot:"title"},slot:"title"},[e._v("场景")]),e._v(" "),t("el-menu-item",{attrs:{index:"createScene"}},[e._v("新建")]),e._v(" "),t("el-menu-item",{attrs:{index:"showScene"}},[e._v("查看")]),e._v(" "),t("el-submenu",{attrs:{index:"2"}},[t("template",{attrs:{slot:"title"},slot:"title"},[e._v("打开")]),e._v(" "),e._l(e.storageFileNames,function(n,i){return t("el-menu-item",{key:i,attrs:{index:n}},[e._v(e._s(n))])}),e._v(" "),t("el-menu-item",{attrs:{index:"importScene"}},[t("span",{staticClass:"fileinput-button"},[t("span",[e._v("导入")]),e._v(" "),t("input",{attrs:{type:"file",id:"import-scene-input"},on:{change:e.importScene}})])])],2),e._v(" "),t("el-menu-item",{attrs:{index:"saveScene"}},[e._v("保存")])],2),e._v(" "),t("el-submenu",{attrs:{index:"edit"}},[t("template",{attrs:{slot:"title"},slot:"title"},[e._v("编辑")]),e._v(" "),t("el-menu-item",{attrs:{index:"2-1"}},[e._v("仅编辑")]),e._v(" "),t("el-menu-item",{attrs:{index:"2-2"}},[e._v("编辑&运行")]),e._v(" "),t("el-menu-item",{attrs:{index:"2-3"}},[e._v("运行")])],2),e._v(" "),t("el-menu-item",{attrs:{index:"about"}},[t("a",{attrs:{href:"#",target:"_blank"}},[e._v("关于")])])],1)],1),e._v(" "),t("div",{attrs:{id:"workbench-toolbar"}},[t("el-button",{attrs:{type:"primary",title:"编辑",icon:"el-icon-setting"},on:{click:e.sceneEdit}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"编辑&运行",icon:"el-icon-menu"},on:{click:e.sceneHalf}}),e._v(" "),t("el-button",{attrs:{type:"primary",title:"运行",icon:"el-icon-d-arrow-right"},on:{click:e.sceneRunning}})],1),e._v(" "),t("div",{attrs:{id:"main-workbench"}},[t("el-row",{staticStyle:{height:"100%"}},[t("el-col",{staticStyle:{height:"100%"},attrs:{span:e.sceneEditorSpan}},[t("SceneEditor")],1),e._v(" "),t("el-col",{staticStyle:{height:"100%"},attrs:{span:e.sceneRunningSpan}},[t("SceneRunning")],1)],1)],1)])},staticRenderFns:[]}},184:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]}},52:function(e,n,t){"use strict";var i={decode:function(e,n){for(var t in e)e[t]instanceof Object||(n[t]=e[t]);var i=n.root.children[0];for(var r in e.bodies){var o=new window.mxCell;o.vertex=!0,o.style="round=1";var a=e.bodies[r],s=a.x,c=a.y,l=a.width,u=a.height,d=a.type,h=a.options;o.geometry=new window.mxGeometry(s,c,l,u),o.name=h.label,o.type=d,o.value=h,i.insert(o)}n.setRoot(n.root)},encode:function(e){var n={name:"",description:"",bodies:[]},t=new window.mxGraphModel;for(var i in e)e[i]instanceof Object||e[i]==t[i]||"nextId"==i||(n[i]=e[i]);for(var r in e.root.children[0].children){var o=e.root.children[0].children[r],a=o.geometry,s=o.value,c=o.type,l=a.x,u=a.y,d=a.width,h=a.height,v={x:l,y:u,width:d,height:h};v.options=s,v.type=c,n.bodies.push(v)}return n}};n.a=i},74:function(e,n,t){"use strict";var i=t(29),r=t(185),o=t(179),a=t.n(o);i.a.use(r.a),n.a=new r.a({routes:[{path:"/",component:a.a}]})},75:function(e,n,t){"use strict";t.d(n,"a",function(){return p});var i,r,o=t(113),a=t.n(o),s=t(29),c=t(28),l=t(18),u=t(71),d=(t.n(u),t(169)),h=t.n(d),v=t(107),m=(t.n(v),t(52));s.a.use(c.d);var p=new c.d.Store({state:function(){return{fileName:"default.scene",sceneData:h.a,editorGraph:null,editorSelectionCell:null,runningRender:null}},getters:{fileName:function(e){return e.fileName},editorGraph:function(e){return e.editorGraph},sceneData:function(e){return e.sceneData},runningRender:function(e){return e.runningRender},engine:function(e){return e.runningRender.engine},world:function(e){return e.runningRender.engine.world}},mutations:(i={},a()(i,l.d,function(e,n){e.runningRender=n}),a()(i,l.e,function(e,n){e.editorGraph=n}),a()(i,l.f,function(e,n){e.editorSelectionCell=n}),a()(i,l.a,function(e,n){var t=n.fileName,i=n.sceneData;e.fileName=t,e.sceneData=i}),i),actions:(r={},a()(r,l.c,function(e){var n=u.Engine.create(),t=u.Render.create({engine:n,options:{pixelRatio:1,background:"gray",wireframeBackground:"blue",hasBounds:!1,enabled:!0,wireframes:!1,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!0,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}});e.commit(l.d,t);for(var i=e.getters.sceneData,r=0;r<i.bodies.length;r++){var o=i.bodies[r],a=null;switch(o.type){case"rectangle":a=u.Bodies.rectangle(o.x,o.y,o.width,o.height,o.options);break;default:console.error("unknown body type"+o.type)}a&&u.World.addBody(n.world,a)}u.Events.on(u.MouseConstraint.create(n),"mousedown",function(e){for(var t=e.mouse.mousedownPosition,i=u.Composite.allBodies(n.world),r=0;r<i.length;r++){var o=i[r];u.Bounds.contains(o.bounds,t)&&u.Vertices.contains(o.vertices,t)&&console.log(o)}})}),a()(r,l.b,function(e){var n=new mxGraph;e.commit(l.e,n),m.a.decode(e.getters.sceneData,n.getModel()),n.getSelectionModel().addListener(mxEvent.CHANGE,function(t,i){var r=n.getSelectionCell();e.commit(l.f,r)}),n.convertValueToString=function(e){return e.value.label},n.valueForCellChanged=function(e,n){e.value.label=n},console.log("model",n.model)}),r)})},77:function(e,n){},78:function(e,n,t){t(168);var i=t(27)(t(102),t(184),null,null);e.exports=i.exports}},[106]);
//# sourceMappingURL=app.a87d69a51ff2ef2da407.js.map